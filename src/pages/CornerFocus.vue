<template>
  <div class="container" @mousemove="onMouseMove">
    <!-- <img ref="wordRef" src="https://source.unsplash.com/random/800x800" /> -->
    <svg
      ref="wordRef"
      class="word"
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 180 60"
    >
      <path
        d="M15 35.8022V24.2057h1.5221v11.5965H15ZM24.7412 35.8022l4.4172-11.5965h1.6397l4.7074 11.5965h-1.7339L32.43 32.29h-4.8094l-1.2632 3.5122h-1.6162Zm3.3188-4.762h3.8993l-1.2004-3.2116c-.3662-.9756-.6381-1.7772-.816-2.4047-.1464.7435-.353 1.4818-.6198 2.2149L28.06 31.0402ZM38.2813 35.8022V24.2057h2.291l2.7224 8.2109c.2511.7647.4342 1.3369.5492 1.7166.1308-.4219.3348-1.0416.612-1.859l2.7539-8.0685h2.0477v11.5965h-1.4672v-9.706l-3.3422 9.706h-1.373l-3.3266-9.8721v9.8721h-1.4672ZM57.2413 35.8022l4.4171-11.5965h1.6398l4.7074 11.5965h-1.7339L64.9301 32.29h-4.8095l-1.2631 3.5122h-1.6162Zm3.3187-4.762h3.8993l-1.2004-3.2116c-.3661-.9756-.6381-1.7772-.8159-2.4047-.1465.7435-.3531 1.4818-.6198 2.2149L60.56 31.0402ZM75.9501 35.8022V24.2057h1.5221v10.2281h5.6646v1.3684h-7.1867ZM86.1009 30.1543c0-1.9249.5126-3.4305 1.5378-4.5169C88.6638 24.5458 89.9872 24 91.6086 24c1.0618 0 2.019.2558 2.8715.7673.8526.5115 1.5012 1.2261 1.9458 2.1437.4498.9123.6747 1.9486.6747 3.1088 0 1.176-.2354 2.2281-.7061 3.1562-.4708.9282-1.1377 1.6322-2.0007 2.1121-.863.4746-1.794.7119-2.7931.7119-1.0827 0-2.0503-.2637-2.9029-.791-.8525-.5274-1.4985-1.2472-1.9379-2.1596-.4393-.9123-.659-1.8774-.659-2.8951Zm1.5692.0237c0 1.3975.3713 2.4997 1.114 3.3065.748.8016 1.6843 1.2024 2.8088 1.2024 1.1455 0 2.087-.4061 2.8245-1.2182.7427-.8121 1.114-1.9644 1.114-3.4568 0-.944-.1595-1.7667-.4785-2.4681-.3139-.7066-.7768-1.2524-1.3887-1.6374-.6068-.3902-1.2893-.5854-2.0478-.5854-1.0774 0-2.0058.3745-2.7852 1.1233-.7741.7436-1.1611 1.9881-1.1611 3.7337ZM100.159 32.0765l1.436-.1266c.068.5801.225 1.0574.47 1.4318.251.3691.638.6697 1.162.9018.523.2267 1.111.3401 1.765.3401.58 0 1.093-.087 1.538-.261.444-.1741.774-.4114.988-.712.22-.3058.33-.6381.33-.9967 0-.3639-.105-.6803-.314-.9492-.209-.2742-.555-.5036-1.036-.6882-.308-.1213-.991-.3085-2.048-.5617-1.056-.2584-1.796-.5009-2.22-.7277-.549-.2901-.96-.6487-1.232-1.0758-.266-.4324-.4-.915-.4-1.4476 0-.5854.165-1.1312.494-1.6375.33-.5115.811-.8991 1.444-1.1628.633-.2637 1.336-.3955 2.111-.3955.852 0 1.603.1398 2.251.4193.654.2742 1.156.6802 1.507 1.2182.35.5379.538 1.147.565 1.8272l-1.46.1108c-.078-.733-.345-1.2868-.8-1.6612-.45-.3744-1.117-.5616-2.001-.5616-.92 0-1.592.1714-2.016.5142-.418.3375-.628.7462-.628 1.2261 0 .4166.149.7594.448 1.0283.292.269 1.056.5458 2.291.8306 1.239.2795 2.089.5247 2.549.7357.67.3111 1.164.7066 1.483 1.1865.319.4746.479 1.0231.479 1.6454 0 .617-.175 1.1997-.526 1.7481-.35.5432-.855.9677-1.514 1.2736-.654.3006-1.391.4509-2.213.4509-1.04 0-1.914-.1529-2.62-.4588-.701-.3059-1.253-.7647-1.655-1.3764-.398-.617-.607-1.3131-.628-2.0883ZM115.927 35.8022v-10.228h-3.789v-1.3685h9.116v1.3685h-3.805v10.228h-1.522ZM130.148 35.8022V24.2057h4.315c.879 0 1.583.1186 2.111.3559.533.2321.949.5933 1.247 1.0838.304.4851.455.994.455 1.5266 0 .4958-.133.9625-.4 1.4002-.266.4377-.669.791-1.208 1.06.696.2056 1.229.5563 1.601 1.052.376.4958.564 1.0811.564 1.7561 0 .5432-.115 1.0495-.345 1.5188-.225.4641-.504.8227-.839 1.0758-.335.2532-.756.4457-1.263.5775-.503.1266-1.12.1898-1.852.1898h-4.386Zm1.522-6.7238h2.487c.675 0 1.159-.0448 1.452-.1344.387-.1161.677-.3085.871-.5775.199-.2689.298-.6064.298-1.0125 0-.385-.092-.7225-.275-1.0125-.183-.2954-.444-.4958-.784-.6012-.34-.1108-.923-.1661-1.75-.1661h-2.299v3.5042Zm0 5.3554h2.864c.492 0 .837-.0185 1.036-.0554.35-.0633.643-.1688.878-.3164.236-.1477.429-.3613.581-.6408.152-.2847.227-.6117.227-.9809 0-.4324-.109-.8068-.329-1.1232-.22-.3217-.526-.5458-.918-.6724-.387-.1318-.947-.1978-1.679-.1978h-2.66v3.9869ZM142.072 30.1543c0-1.9249.513-3.4305 1.538-4.5169C144.635 24.5458 145.958 24 147.58 24c1.062 0 2.019.2558 2.871.7673.853.5115 1.502 1.2261 1.946 2.1437.45.9123.675 1.9486.675 3.1088 0 1.176-.236 2.2281-.706 3.1562-.471.9282-1.138 1.6322-2.001 2.1121-.863.4746-1.794.7119-2.793.7119-1.083 0-2.05-.2637-2.903-.791-.852-.5274-1.498-1.2472-1.938-2.1596-.439-.9123-.659-1.8774-.659-2.8951Zm1.569.0237c0 1.3975.372 2.4997 1.114 3.3065.748.8016 1.685 1.2024 2.809 1.2024 1.146 0 2.087-.4061 2.825-1.2182.742-.8121 1.114-1.9644 1.114-3.4568 0-.944-.16-1.7667-.479-2.4681-.314-.7066-.777-1.2524-1.389-1.6374-.606-.3902-1.289-.5854-2.047-.5854-1.078 0-2.006.3745-2.786 1.1233-.774.7436-1.161 1.9881-1.161 3.7337ZM159.888 35.8022v-4.9123l-4.433-6.6842h1.852l2.267 3.4963c.419.654.808 1.3079 1.169 1.9618.346-.6065.764-1.2894 1.256-2.0488l2.228-3.4093H166l-4.59 6.6842v4.9123h-1.522Z"
      />
      <g ref="group" />
    </svg>
  </div>
</template>

<script setup>
import { ref, reactive, onMounted, watch } from "vue";
import gsap from "gsap";

const wordRef = ref();
const group = ref();
const temp = ref(0);

let delay = 0;
const wordAni = gsap.timeline({ paused: true });

const mouse = reactive({
  x: -100,
  y: -100,
});

const onMouseMove = (e) => {
  mouse.x = e.pageX - window.innerWidth / 2;
  mouse.y = e.pageY - window.innerHeight / 2;

  const imgX = mouse.x / window.innerWidth;
  const imgY = mouse.y / window.innerHeight;
  temp.value = Math.max(Math.abs(imgX), Math.abs(imgY));

  temp.value = Math.round(temp.value * 100) * 2;
};

watch(temp, () => {
  wordAni.progress(temp.value / 100);
});

onMounted(() => {
  const items = document.querySelectorAll(".word > path");
  items.forEach((item) => {
    const length = item.getTotalLength();
    for (let i = 0; i < length; i++) {
      const pointLength = Math.random() * length;
      const point = item.getPointAtLength(pointLength);
      const circle = document.createElementNS(
        "http://www.w3.org/2000/svg",
        "circle"
      );
      circle.setAttribute("cx", point.x);
      circle.setAttribute("cy", point.y);
      circle.setAttribute("r", Math.random() * 0.5 + 0.1);
      circle.setAttribute("fill", "white");
      group.value.appendChild(circle);

      wordAni.to(
        circle,
        {
          cx: point.x + (Math.random() - 0.5) * 50,
          cy: point.y + (Math.random() - 0.5) * 50,
          opacity: 0,
          delay: (delay + pointLength) * 0.001,
        },
        0
      );
    }
  });
});
</script>

<style lang="scss" scoped>
.container {
  width: 100%;
  height: calc(var(--vh) * 100);
  background: rgb(22, 22, 22);
  .word {
    path {
      opacity: 0;
    }
  }
}
</style>
